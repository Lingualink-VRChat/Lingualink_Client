好的，为了完善 LinguaLink 客户端的国际化，我将根据您的要求，对现有代码进行以下修改和补充：

1.  **修复清除日志按钮没有文本的问题**：为 `LogPage.xaml` 中的“清除日志”和“运行日志”按钮和标签绑定正确的本地化字符串。
2.  **汉化缺失的按钮和文本**：
    *   `MainWindow` 的标题。
    *   `IndexPage` 中“开始工作”/“停止工作”按钮的动态文本。
    *   `ServicePage` 中音量阈值设置的提示文本。
    *   `IndexWindowViewModel` 和 `AudioService` 中所有的状态提示和日志信息（包括成功、失败、正在进行等）。
    *   `ServicePageViewModel` 中的验证和操作提示信息。
    *   `TranslationService` 中的错误信息。

**核心改动思路：**
*   在 `Properties/Lang.resx` (英文) 和 `Properties/Lang.zh-CN.resx` (简体中文) 中添加所有缺失或需要本地化的字符串资源。
*   在对应的 ViewModel 中，将硬编码的字符串替换为通过 `LanguageManager.GetString()` 方法获取本地化字符串的属性。
*   对于包含动态内容的字符串（如错误信息、状态提示），使用格式字符串（例如 `"{0}"`）和 `string.Format()` 方法。
*   确保 ViewModel 中的这些属性在 `LanguageManager.LanguageChanged` 事件发生时能够更新 UI。
*   修正 `IndexPage.xaml` 中工作按钮的绑定，使其能够正确显示动态文本。

---

**详细修改内容：**

**1. `Properties/Lang.resx` (英文资源文件)**

```xml
<?xml version="1.0" encoding="utf-8"?>
<root>
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="InterfaceLanguage" xml:space="preserve">
    <value>Interface Language</value>
  </data>
  <data name="ServerUrl" xml:space="preserve">
    <value>Server URL</value>
  </data>
  <data name="SilenceThreshold" xml:space="preserve">
    <value>Silence Detection Threshold (seconds)</value>
  </data>
  <data name="MinVoiceDuration" xml:space="preserve">
    <value>Minimum Voice Duration (seconds)</value>
  </data>
  <data name="MaxVoiceDuration" xml:space="preserve">
    <value>Maximum Voice Duration (seconds)</value>
  </data>
  <data name="MinVolumeThreshold" xml:space="preserve">
    <value>Minimum Recording Volume Threshold (0-100%)</value>
  </data>
  <data name="EnableOsc" xml:space="preserve">
    <value>Enable OSC Sending</value>
  </data>
  <data name="OscIpAddress" xml:space="preserve">
    <value>OSC IP Address</value>
  </data>
  <data name="OscPort" xml:space="preserve">
    <value>OSC Port</value>
  </data>
  <data name="SendImmediately" xml:space="preserve">
    <value>Send Immediately (Bypass Keyboard)</value>
  </data>
  <data name="PlayNotificationSound" xml:space="preserve">
    <value>Play Notification Sound</value>
  </data>
  <data name="Save" xml:space="preserve">
    <value>Save</value>
  </data>
  <data name="UndoChanges" xml:space="preserve">
    <value>Undo Changes</value>
  </data>
  <data name="RunningLog" xml:space="preserve">
    <value>Running Log</value>
  </data>
  <data name="ClearLog" xml:space="preserve">
    <value>Clear Log</value>
  </data>
  <data name="SelectMicrophone" xml:space="preserve">
    <value>Select Microphone</value>
  </data>
  <data name="Refresh" xml:space="preserve">
    <value>Refresh</value>
  </data>
  <data name="Remove" xml:space="preserve">
    <value>Remove</value>
  </data>
  <data name="AddLanguage" xml:space="preserve">
    <value>Add Language</value>
  </data>
  <data name="Start" xml:space="preserve">
    <value>Start</value>
  </data>
  <data name="Service" xml:space="preserve">
    <value>Service</value>
  </data>
  <data name="Log" xml:space="preserve">
    <value>Log</value>
  </data>
  <data name="Settings" xml:space="preserve">
    <value>Settings</value>
  </data>
  <data name="TargetLanguageLabel" xml:space="preserve">
    <value>Target Language</value>
  </data>

  <!-- Newly Added/Modified Strings -->
  <data name="StartWork" xml:space="preserve">
    <value>Start Work</value>
  </data>
  <data name="StopWork" xml:space="preserve">
    <value>Stop Work</value>
  </data>
  <data name="VolumeThresholdHint" xml:space="preserve">
    <value>Hint: Audio will only be processed if microphone input volume exceeds this threshold. 0% disables this filtering.</value>
  </data>
  <data name="AppTitle" xml:space="preserve">
    <value>LinguaLink - Client</value>
  </data>
  <data name="AppTitleBar" xml:space="preserve">
    <value>VRChat LinguaLink - Client</value>
  </data>

  <!-- Status Messages (IndexWindowViewModel) -->
  <data name="StatusInitializing" xml:space="preserve">
    <value>Status: Initializing...</value>
  </data>
  <data name="StatusSettingsUpdated" xml:space="preserve">
    <value>Status: Settings updated.</value>
  </data>
  <data name="StatusPleaseSelectMic" xml:space="preserve">
    <value>Please select a microphone.</value>
  </data>
  <data name="StatusReadyWithOsc" xml:space="preserve">
    <value>Ready to start working and send to VRChat.</value>
  </data>
  <data name="StatusReadyWithoutOsc" xml:space="preserve">
    <value>Ready to start working.</value>
  </data>
  <data name="StatusOscEnabled" xml:space="preserve">
    <value>Status: OSC service enabled ({0}:{1}).</value>
  </data>
  <data name="StatusOscInitFailed" xml:space="preserve">
    <value>Status: OSC service initialization failed: {0}</value>
  </data>
  <data name="LogOscInitFailed" xml:space="preserve">
    <value>OSC service initialization failed: {0}</value>
  </data>
  <data name="StatusRefreshingMics" xml:space="preserve">
    <value>Status: Refreshing microphone list...</value>
  </data>
  <data name="StatusRefreshMicsFailed" xml:space="preserve">
    <value>Status: Failed to refresh microphone list: {0}</value>
  </data>
  <data name="LogRefreshMicsFailed" xml:space="preserve">
    <value>Failed to refresh microphone list: {0}</value>
  </data>
  <data name="StatusNoMicFound" xml:space="preserve">
    <value>Status: No microphone devices found!</value>
  </data>
  <data name="StatusMicsRefreshed" xml:space="preserve">
    <value>Status: Microphone list refreshed.</value>
  </data>
  <data name="StatusMicSelected" xml:space="preserve">
    <value>Status: Microphone selected: {0}</value>
  </data>
  <data name="StatusMicSelectedFallback" xml:space="preserve">
    <value>Status: Microphone selected (fallback index): {0}</value>
  </data>
  <data name="StatusMicInvalid" xml:space="preserve">
    <value>Status: Microphone '{0}' is invalid.</value>
  </data>
  <data name="StatusNoMicFoundRefreshCheck" xml:space="preserve">
    <value>Status: No microphone devices found. Please refresh or check devices.</value>
  </data>
  <data name="StatusStopped" xml:space="preserve">
    <value>Status: Stopped.</value>
  </data>
  <data name="StatusSendingSegment" xml:space="preserve">
    <value>Status: Sending segment ({0})...</value>
  </data>
  <data name="LogSendingSegment" xml:space="preserve">
    <value>Sending segment ({0}, {1} bytes) at {2:HH:mm:ss}</value>
  </data>
  <data name="LogServerRawResponse" xml:space="preserve">
    <value>Server raw response ({0}): {1}</value>
  </data>
  <data name="StatusTranslationFailed" xml:space="preserve">
    <value>Status: Translation request failed.</value>
  </data>
  <data name="TranslationError" xml:space="preserve">
    <value>Error: {0}</value>
  </data>
  <data name="LogTranslationError" xml:space="preserve">
    <value>Translation error ({0}): {1}</value>
  </data>
  <data name="StatusTranslationSuccess" xml:space="preserve">
    <value>Status: Translation successful!</value>
  </data>
  <data name="LogTranslationSuccess" xml:space="preserve">
    <value>Translation successful ({0}): "{1}" (LLM: {2:F2}s)</value>
  </data>
  <data name="StatusTranslationSuccessNoText" xml:space="preserve">
    <value>Status: Translation successful, but no text content.</value>
  </data>
  <data name="TranslationSuccessNoTextPlaceholder" xml:space="preserve">
    <value>(Server returned success, but no text content)</value>
  </data>
  <data name="LogTranslationSuccessNoText" xml:space="preserve">
    <value>Translation successful but no text ({0}). (LLM: {1:F2}s)</value>
  </data>
  <data name="StatusTranslationFailedServer" xml:space="preserve">
    <value>Status: Translation failed (server error).</value>
  </data>
  <data name="TranslationServerError" xml:space="preserve">
    <value>Server error: {0}</value>
  </data>
  <data name="LogServerError" xml:space="preserve">
    <value>Server processing error ({0}): {1}</value>
  </data>
  <data name="LogServerErrorDetails" xml:space="preserve">
    <value> | Details: {0}</value>
  </data>
  <data name="StatusEmptyResponse" xml:space="preserve">
    <value>Status: Received empty response.</value>
  </data>
  <data name="TranslationEmptyResponseError" xml:space="preserve">
    <value>Error: Empty server response</value>
  </data>
  <data name="LogEmptyResponse" xml:space="preserve">
    <value>Received empty response ({0})</value>
  </data>
  <data name="StatusSendingToVRChat" xml:space="preserve">
    <value>Status: Translation successful! Sending to VRChat...</value>
  </data>
  <data name="LogOscSent" xml:space="preserve">
    <value>[OSC] Message sent to VRChat: "{0}..."</value>
  </data>
  <data name="StatusOscSendFailed" xml:space="preserve">
    <value>Status: Translation successful! But VRChat send failed: {0}</value>
  </data>
  <data name="LogOscSendFailed" xml:space="preserve">
    <value>[OSC ERROR] Send failed: {0}</value>
  </data>
  <data name="StatusListening" xml:space="preserve">
    <value>Status: Listening...</value>
  </data>
  <data name="LogCleared" xml:space="preserve">
    <value>Log cleared.</value>
  </data>
  <data name="LogTargetLangsSaved" xml:space="preserve">
    <value>Target language settings updated and saved.</value>
  </data>
  <data name="IndexVmCtorLogInit" xml:space="preserve">
    <value>IndexWindowViewModel Constructor: Log Initialized.</value>
  </data>
  <data name="UnknownError" xml:space="preserve">
    <value>Unknown error</value>
  </data>
  <data name="DefaultEnglishLanguageName" xml:space="preserve">
    <value>English</value>
  </data>

  <!-- AudioService Status Messages -->
  <data name="AudioStatusListening" xml:space="preserve">
    <value>Listening...</value>
  </data>
  <data name="AudioStatusStartFailed" xml:space="preserve">
    <value>Failed to start listening: {0}</value>
  </data>
  <data name="AudioStatusSpeechDetected" xml:space="preserve">
    <value>Speech detected...</value>
  </data>
  <data name="AudioStatusSpeechDetectedSplit" xml:space="preserve">
    <value>Speech detected (split)...</value>
  </data>
  <data name="AudioStatusSilenceDetectedProcess" xml:space="preserve">
    <value>Silence detected, preparing to process...</value>
  </data>
  <data name="AudioStatusSegmentTooShort" xml:space="preserve">
    <value>Audio segment too short, ignored. Listening...</value>
  </data>
  <data name="AudioStatusFatalError" xml:space="preserve">
    <value>Fatal error during listening: {0}</value>
  </data>

  <!-- ServicePageViewModel Validation/Confirmation Messages -->
  <data name="ValidationErrorTitle" xml:space="preserve">
    <value>Validation Error</value>
  </data>
  <data name="ValidationServerUrlInvalid" xml:space="preserve">
    <value>Server URL is invalid.</value>
  </data>
  <data name="ValidationSilenceThresholdInvalid" xml:space="preserve">
    <value>Silence detection threshold must be a positive number.</value>
  </data>
  <data name="ValidationMinVoiceDurationInvalid" xml:space="preserve">
    <value>Minimum voice duration must be a positive number.</value>
  </data>
  <data name="ValidationMaxVoiceDurationInvalid" xml:space="preserve">
    <value>Maximum voice duration must be a positive number.</value>
  </data>
  <data name="ValidationMinMaxVoiceDuration" xml:space="preserve">
    <value>Minimum voice duration must be less than maximum voice duration.</value>
  </data>
  <data name="ValidationOscIpInvalid" xml:space="preserve">
    <value>OSC IP Address is invalid.</value>
  </data>
  <data name="ValidationOscPortInvalid" xml:space="preserve">
    <value>OSC Port number must be between 1-65535.</value>
  </data>
  <data name="SuccessTitle" xml:space="preserve">
    <value>Success</value>
  </data>
  <data name="SettingsSavedSuccess" xml:space="preserve">
    <value>Service-related settings saved successfully.</value>
  </data>
  <data name="InfoTitle" xml:space="preserve">
    <value>Info</value>
  </data>
  <data name="SettingsReverted" xml:space="preserve">
    <value>Changes reverted, settings reloaded from last saved state.</value>
  </data>

  <!-- TranslationService Error Messages -->
  <data name="ErrorAudioEmpty" xml:space="preserve">
    <value>Audio data is empty.</value>
  </data>
  <data name="ErrorDeserializingSuccessResponse" xml:space="preserve">
    <value>Failed to deserialize server success response: {0}. Response: {1}</value>
  </data>
  <data name="ErrorServer" xml:space="preserve">
    <value>Server error ({0}): {1}</value>
  </data>
  <data name="ErrorNetworkTimeout" xml:space="preserve">
    <value>Network request timed out: {0}</value>
  </data>
  <data name="ErrorNetworkRequest" xml:space="preserve">
    <value>Network request error: {0}</value>
  </data>
  <data name="ErrorProcessingSendingSegment" xml:space="preserve">
    <value>Error processing/sending segment: {0}</value>
  </data>
  <data name="ErrorEmptyServerResponse" xml:space="preserve">
    <value>Error: Empty server response</value>
  </data>
</root>
```

**2. `Properties/Lang.zh-CN.resx` (简体中文资源文件)**

```xml
<?xml version="1.0" encoding="utf-8"?>
<root>
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="InterfaceLanguage" xml:space="preserve">
    <value>界面语言</value>
  </data>
  <data name="ServerUrl" xml:space="preserve">
    <value>服务器 URL</value>
  </data>
  <data name="SilenceThreshold" xml:space="preserve">
    <value>静音检测阈值 (秒)</value>
  </data>
  <data name="MinVoiceDuration" xml:space="preserve">
    <value>最小语音时长 (秒)</value>
  </data>
  <data name="MaxVoiceDuration" xml:space="preserve">
    <value>最大语音时长 (秒)</value>
  </data>
  <data name="MinVolumeThreshold" xml:space="preserve">
    <value>最小录音音量阈值 (0-100%)</value>
  </data>
  <data name="EnableOsc" xml:space="preserve">
    <value>启用 OSC 发送</value>
  </data>
  <data name="OscIpAddress" xml:space="preserve">
    <value>OSC IP 地址</value>
  </data>
  <data name="OscPort" xml:space="preserve">
    <value>OSC 端口</value>
  </data>
  <data name="SendImmediately" xml:space="preserve">
    <value>立即发送 (绕过键盘)</value>
  </data>
  <data name="PlayNotificationSound" xml:space="preserve">
    <value>播放通知音效</value>
  </data>
  <data name="Save" xml:space="preserve">
    <value>保存</value>
  </data>
  <data name="UndoChanges" xml:space="preserve">
    <value>撤销更改</value>
  </data>
  <data name="RunningLog" xml:space="preserve">
    <value>运行日志</value>
  </data>
  <data name="ClearLog" xml:space="preserve">
    <value>清除日志</value>
  </data>
  <data name="SelectMicrophone" xml:space="preserve">
    <value>选择麦克风</value>
  </data>
  <data name="Refresh" xml:space="preserve">
    <value>刷新</value>
  </data>
  <data name="Remove" xml:space="preserve">
    <value>移除</value>
  </data>
  <data name="AddLanguage" xml:space="preserve">
    <value>增加语言</value>
  </data>
  <data name="Start" xml:space="preserve">
    <value>启动</value>
  </data>
  <data name="Service" xml:space="preserve">
    <value>服务</value>
  </data>
  <data name="Log" xml:space="preserve">
    <value>日志</value>
  </data>
  <data name="Settings" xml:space="preserve">
    <value>设置</value>
  </data>
  <data name="TargetLanguageLabel" xml:space="preserve">
    <value>目标语言</value>
  </data>

  <!-- Newly Added/Modified Strings -->
  <data name="StartWork" xml:space="preserve">
    <value>开始工作</value>
  </data>
  <data name="StopWork" xml:space="preserve">
    <value>停止工作</value>
  </data>
  <data name="VolumeThresholdHint" xml:space="preserve">
    <value>提示: 仅当麦克风输入音量高于此阈值时才开始处理语音。0% 表示禁用此过滤。</value>
  </data>
  <data name="AppTitle" xml:space="preserve">
    <value>凌语连声 - 客户端</value>
  </data>
  <data name="AppTitleBar" xml:space="preserve">
    <value>VRChat 凌语连声 - 客户端</value>
  </data>

  <!-- Status Messages (IndexWindowViewModel) -->
  <data name="StatusInitializing" xml:space="preserve">
    <value>状态：正在初始化...</value>
  </data>
  <data name="StatusSettingsUpdated" xml:space="preserve">
    <value>状态：设置已更新。</value>
  </data>
  <data name="StatusPleaseSelectMic" xml:space="preserve">
    <value>请选择麦克风。</value>
  </data>
  <data name="StatusReadyWithOsc" xml:space="preserve">
    <value>可开始工作并发送至VRChat。</value>
  </data>
  <data name="StatusReadyWithoutOsc" xml:space="preserve">
    <value>可开始工作。</value>
  </data>
  <data name="StatusOscEnabled" xml:space="preserve">
    <value>状态：OSC服务已启用 ({0}:{1})。</value>
  </data>
  <data name="StatusOscInitFailed" xml:space="preserve">
    <value>状态：OSC服务初始化失败: {0}</value>
  </data>
  <data name="LogOscInitFailed" xml:space="preserve">
    <value>OSC服务初始化失败: {0}</value>
  </data>
  <data name="StatusRefreshingMics" xml:space="preserve">
    <value>状态：正在刷新麦克风列表...</value>
  </data>
  <data name="StatusRefreshMicsFailed" xml:space="preserve">
    <value>状态：刷新麦克风列表失败: {0}</value>
  </data>
  <data name="LogRefreshMicsFailed" xml:space="preserve">
    <value>刷新麦克风列表失败: {0}</value>
  </data>
  <data name="StatusNoMicFound" xml:space="preserve">
    <value>状态：未找到可用的麦克风设备！</value>
  </data>
  <data name="StatusMicsRefreshed" xml:space="preserve">
    <value>状态：麦克风列表已刷新。</value>
  </data>
  <data name="StatusMicSelected" xml:space="preserve">
    <value>状态：已选择麦克风: {0}</value>
  </data>
  <data name="StatusMicSelectedFallback" xml:space="preserve">
    <value>状态：已选择麦克风 (回退索引): {0}</value>
  </data>
  <data name="StatusMicInvalid" xml:space="preserve">
    <value>状态：麦克风 '{0}' 无效。</value>
  </data>
  <data name="StatusNoMicFoundRefreshCheck" xml:space="preserve">
    <value>状态：未找到可用的麦克风设备。请刷新或检查设备。</value>
  </data>
  <data name="StatusStopped" xml:space="preserve">
    <value>状态：已停止。</value>
  </data>
  <data name="StatusSendingSegment" xml:space="preserve">
    <value>状态：正在发送片段 ({0})...</value>
  </data>
  <data name="LogSendingSegment" xml:space="preserve">
    <value>发送片段 ({0}, {1} bytes) at {2:HH:mm:ss}</value>
  </data>
  <data name="LogServerRawResponse" xml:space="preserve">
    <value>服务端原始响应 ({0}): {1}</value>
  </data>
  <data name="StatusTranslationFailed" xml:space="preserve">
    <value>状态：翻译请求失败。</value>
  </data>
  <data name="TranslationError" xml:space="preserve">
    <value>错误: {0}</value>
  </data>
  <data name="LogTranslationError" xml:space="preserve">
    <value>翻译错误 ({0}): {1}</value>
  </data>
  <data name="StatusTranslationSuccess" xml:space="preserve">
    <value>状态：翻译成功！</value>
  </data>
  <data name="LogTranslationSuccess" xml:space="preserve">
    <value>翻译成功 ({0}): "{1}" (LLM: {2:F2}s)</value>
  </data>
  <data name="StatusTranslationSuccessNoText" xml:space="preserve">
    <value>状态：翻译成功，但无文本内容。</value>
  </data>
  <data name="TranslationSuccessNoTextPlaceholder" xml:space="preserve">
    <value>(服务器返回成功，但无文本内容)</value>
  </data>
  <data name="LogTranslationSuccessNoText" xml:space="preserve">
    <value>翻译成功但无文本 ({0}). (LLM: {1:F2}s)</value>
  </data>
  <data name="StatusTranslationFailedServer" xml:space="preserve">
    <value>状态：翻译失败 (服务器)。</value>
  </data>
  <data name="TranslationServerError" xml:space="preserve">
    <value>服务器错误: {0}</value>
  </data>
  <data name="LogServerError" xml:space="preserve">
    <value>服务器处理错误 ({0}): {1}</value>
  </data>
  <data name="LogServerErrorDetails" xml:space="preserve">
    <value> | 详情: {0}</value>
  </data>
  <data name="StatusEmptyResponse" xml:space="preserve">
    <value>状态：收到空响应。</value>
  </data>
  <data name="TranslationEmptyResponseError" xml:space="preserve">
    <value>错误: 服务器空响应</value>
  </data>
  <data name="LogEmptyResponse" xml:space="preserve">
    <value>收到空响应 ({0})</value>
  </data>
  <data name="StatusSendingToVRChat" xml:space="preserve">
    <value>状态：翻译成功！正在发送到VRChat...</value>
  </data>
  <data name="LogOscSent" xml:space="preserve">
    <value>[OSC] 消息已发送到VRChat: "{0}..."</value>
  </data>
  <data name="StatusOscSendFailed" xml:space="preserve">
    <value>状态：翻译成功！但VRChat发送失败: {0}</value>
  </data>
  <data name="LogOscSendFailed" xml:space="preserve">
    <value>[OSC ERROR] 发送失败: {0}</value>
  </data>
  <data name="StatusListening" xml:space="preserve">
    <value>状态：正在监听...</value>
  </data>
  <data name="LogCleared" xml:space="preserve">
    <value>日志已清除。</value>
  </data>
  <data name="LogTargetLangsSaved" xml:space="preserve">
    <value>目标语言设置已更新并保存。</value>
  </data>
  <data name="IndexVmCtorLogInit" xml:space="preserve">
    <value>IndexWindowViewModel Constructor: 日志已初始化。</value>
  </data>
  <data name="UnknownError" xml:space="preserve">
    <value>未知错误</value>
  </data>
  <data name="DefaultEnglishLanguageName" xml:space="preserve">
    <value>英文</value>
  </data>

  <!-- AudioService Status Messages -->
  <data name="AudioStatusListening" xml:space="preserve">
    <value>正在监听...</value>
  </data>
  <data name="AudioStatusStartFailed" xml:space="preserve">
    <value>启动监听失败: {0}</value>
  </data>
  <data name="AudioStatusSpeechDetected" xml:space="preserve">
    <value>检测到语音...</value>
  </data>
  <data name="AudioStatusSpeechDetectedSplit" xml:space="preserve">
    <value>检测到语音 (已切分)...</value>
  </data>
  <data name="AudioStatusSilenceDetectedProcess" xml:space="preserve">
    <value>检测到静音，准备处理...</value>
  </data>
  <data name="AudioStatusSegmentTooShort" xml:space="preserve">
    <value>语音片段过短，已忽略。正在监听...</value>
  </data>
  <data name="AudioStatusFatalError" xml:space="preserve">
    <value>监听时发生严重错误: {0}</value>
  </data>

  <!-- ServicePageViewModel Validation/Confirmation Messages -->
  <data name="ValidationErrorTitle" xml:space="preserve">
    <value>验证错误</value>
  </data>
  <data name="ValidationServerUrlInvalid" xml:space="preserve">
    <value>服务器URL无效。</value>
  </data>
  <data name="ValidationSilenceThresholdInvalid" xml:space="preserve">
    <value>静音检测阈值必须是正数。</value>
  </data>
  <data name="ValidationMinVoiceDurationInvalid" xml:space="preserve">
    <value>最小语音时长必须是正数。</value>
  </data>
  <data name="ValidationMaxVoiceDurationInvalid" xml:space="preserve">
    <value>最大语音时长必须是正数。</value>
  </data>
  <data name="ValidationMinMaxVoiceDuration" xml:space="preserve">
    <value>最小语音时长必须小于最大语音时长。</value>
  </data>
  <data name="ValidationOscIpInvalid" xml:space="preserve">
    <value>OSC IP地址无效。</value>
  </data>
  <data name="ValidationOscPortInvalid" xml:space="preserve">
    <value>OSC端口号必须在 1-65535 之间。</value>
  </data>
  <data name="SuccessTitle" xml:space="preserve">
    <value>成功</value>
  </data>
  <data name="SettingsSavedSuccess" xml:space="preserve">
    <value>服务相关设置已保存。</value>
  </data>
  <data name="InfoTitle" xml:space="preserve">
    <value>提示</value>
  </data>
  <data name="SettingsReverted" xml:space="preserve">
    <value>更改已撤销，设置已从上次保存的状态重新加载。</value>
  </data>

  <!-- TranslationService Error Messages -->
  <data name="ErrorAudioEmpty" xml:space="preserve">
    <value>音频数据为空。</value>
  </data>
  <data name="ErrorDeserializingSuccessResponse" xml:space="preserve">
    <value>反序列化服务器成功响应失败: {0}。响应: {1}</value>
  </data>
  <data name="ErrorServer" xml:space="preserve">
    <value>服务器错误 ({0}): {1}</value>
  </data>
  <data name="ErrorNetworkTimeout" xml:space="preserve">
    <value>网络请求超时: {0}</value>
  </data>
  <data name="ErrorNetworkRequest" xml:space="preserve">
    <value>网络请求错误: {0}</value>
  </data>
  <data name="ErrorProcessingSendingSegment" xml:space="preserve">
    <value>处理/发送片段出错: {0}</value>
  </data>
  <data name="ErrorEmptyServerResponse" xml:space="preserve">
    <value>错误: 服务器空响应</value>
  </data>
</root>
```

**3. `MainWindow.xaml`**

*   更新 `Title` 和 `ui:TitleBar` 的 `Title` 绑定到 `MainWindowViewModel` 中新增的本地化属性。

```xml
File: MainWindow.xaml
```xml
﻿<ui:FluentWindow
    x:Class="lingualink_client.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:lingualink_client"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:pages="clr-namespace:lingualink_client.Views"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="{Binding AppTitle}"  <!-- 修改点 -->
    Width="1100"
    Height="650"
    d:DesignHeight="450"
    d:DesignWidth="800"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Closed="MainWindow_Closed"
    ExtendsContentIntoTitleBar="True"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Icon="/Assets/Icons/icon_128x128.ico"
    WindowBackdropType="Mica"
    WindowCornerPreference="Round"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <ui:TitleBar
            Title="{Binding AppTitleBar}" <!-- 修改点 -->
            Grid.Row="0"
            Icon="{ui:ImageIcon 'pack://application:,,,/lingualink_client;component/Assets/Icons/icon_128x128.ico'}">
            <ui:TitleBar.TrailingContent>
                <ToggleButton
                    VerticalAlignment="Top"
                    BorderThickness="0"
                    Checked="ThemesChanged"
                    Unchecked="ThemesChanged">
                    <ui:SymbolIcon Symbol="DarkTheme24" />
                </ToggleButton>
            </ui:TitleBar.TrailingContent>
        </ui:TitleBar>

        <ui:NavigationView
            x:Name="RootNavigation"
            Grid.Row="1"
            IsBackButtonVisible="Collapsed"
            OpenPaneLength="150">
            <ui:NavigationView.Header>
                <ui:BreadcrumbBar
                    Margin="42,32,0,0"
                    FontSize="28"
                    FontWeight="DemiBold" />
            </ui:NavigationView.Header>
            <ui:NavigationView.MenuItems>
                <ui:NavigationViewItem
                    Content="{Binding Start}"
                    NavigationCacheMode="Enabled"
                    TargetPageType="{x:Type pages:IndexPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Home24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>
                <ui:NavigationViewItem
                    Content="{Binding Service}"
                    NavigationCacheMode="Enabled"
                    TargetPageType="{x:Type pages:ServicePage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="ServerSurfaceMultiple16" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>
                <ui:NavigationViewItem
                    Content="{Binding Log}"
                    NavigationCacheMode="Enabled"
                    TargetPageType="{x:Type pages:LogPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="TextBulletListLtr24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>
            </ui:NavigationView.MenuItems>
            <ui:NavigationView.FooterMenuItems>
                <ui:NavigationViewItem
                    Content="{Binding Settings}"
                    NavigationCacheMode="Disabled"
                    TargetPageType="{x:Type pages:SettingPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Settings24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>
            </ui:NavigationView.FooterMenuItems>
        </ui:NavigationView>
    </Grid>
</ui:FluentWindow>
```

**4. `MainWindowViewModel.cs`**

*   添加 `AppTitle` 和 `AppTitleBar` 属性，并订阅语言变更事件。

```csharp
File: ViewModels/MainWindowViewModel.cs
```csharp
﻿using lingualink_client.Services;

namespace lingualink_client.ViewModels
{
    public class MainWindowViewModel : ViewModelBase
    {
        public string Start => LanguageManager.GetString("Start");
        public string Service => LanguageManager.GetString("Service");
        public string Log => LanguageManager.GetString("Log");
        public string Settings => LanguageManager.GetString("Settings");
        public string AppTitle => LanguageManager.GetString("AppTitle"); // 新增
        public string AppTitleBar => LanguageManager.GetString("AppTitleBar"); // 新增

        public MainWindowViewModel()
        {
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(Start));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(Service));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(Log));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(Settings));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(AppTitle)); // 订阅语言变更
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(AppTitleBar)); // 订阅语言变更
        }
    }
}
```

**5. `Views/Pages/IndexPage.xaml`**

*   修改工作按钮的 `Content` 绑定为 `WorkButtonContent`，因为它是一个动态变化的文本。
*   修正 `RemoveCommand` 的绑定名称为 `RemoveItemCommand` (CommunityToolkit.Mvvm 约定)。

```xml
File: Views/Pages/IndexPage.xaml
```xml
﻿<Page
    x:Class="lingualink_client.Views.IndexPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:lingualink_client.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:lingualink_client.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:lingualink_client.ViewModels"
    Title="IndexPage"
    d:DataContext="{d:DesignInstance Type=vm:IndexWindowViewModel}"
    mc:Ignorable="d">

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <!--  Only one column now  -->
        </Grid.ColumnDefinitions>

        <!--  Main Controls (was Left Column)  -->
        <Grid Grid.Column="0">
            <!--  Margin="0,0,5,0" removed  -->
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <!--  Mic Selection  -->
                <RowDefinition Height="Auto" />
                <!--  Target Languages Expander  -->
                <RowDefinition Height="Auto" />
                <!--  Work Button  -->
                <RowDefinition Height="Auto" />
                <!--  Status Text  -->
                <RowDefinition Height="*" />
                <!--  Translation Result  -->
                <RowDefinition Height="Auto" />
                <!--  Hint  -->
            </Grid.RowDefinitions>

            <StackPanel
                Grid.Row="0"
                Margin="0,0,0,10"
                Orientation="Horizontal">
                <Label VerticalAlignment="Center" Content="{Binding SelectMicrophoneLabel}" />
                <ComboBox
                    Width="200"
                    Margin="5,0,0,0"
                    VerticalAlignment="Center"
                    DisplayMemberPath="FriendlyName"
                    IsEnabled="{Binding IsMicrophoneComboBoxEnabled}"
                    ItemsSource="{Binding Microphones}"
                    SelectedItem="{Binding SelectedMicrophone}" />
                <ui:Button
                    Margin="10,0,0,0"
                    Padding="5,2"
                    VerticalAlignment="Center"
                    Command="{Binding RefreshMicrophonesCommand}"
                    Content="{Binding RefreshLabel}" />
                <StatusBar
                    Margin="10,0,0,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Background="Transparent"
                    Opacity="0.7"
                    Visibility="{Binding IsRefreshingMicrophones, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <StatusBarItem>
                        <ui:TextBlock Text="{Binding RefreshingMicrophonesLabel}" />
                    </StatusBarItem>
                </StatusBar>
            </StackPanel>

            <ui:CardExpander
                Grid.Row="1"
                Margin="0,0,0,10"
                Header="{Binding TargetLanguagesLabel}"
                IsExpanded="True">
                <StackPanel Margin="10,5,0,0">
                    <ItemsControl ItemsSource="{Binding TargetLanguageItems}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="{x:Type vm:SelectableTargetLanguageViewModel}">
                                <Grid Margin="0,3,0,3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ui:TextBlock
                                        Grid.Column="0"
                                        Margin="0,0,8,0"
                                        VerticalAlignment="Center"
                                        Text="{Binding Label}" />
                                    <ComboBox
                                        Grid.Column="1"
                                        MinWidth="150"
                                        MaxWidth="200"
                                        HorizontalAlignment="Stretch"
                                        ItemsSource="{Binding AvailableLanguages}"
                                        SelectedItem="{Binding SelectedLanguage}" />
                                    <ui:Button
                                        Grid.Column="2"
                                        Margin="8,0,0,0"
                                        Padding="5,2"
                                        VerticalAlignment="Center"
                                        Command="{Binding RemoveItemCommand}" <!-- 修改点 -->
                                        Content="{Binding RemoveLabel}"
                                        Visibility="{Binding CanRemove, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    <ui:Button
                        Margin="0,5,0,0"
                        Padding="5,2"
                        HorizontalAlignment="Left"
                        Command="{Binding AddLanguageCommand}"
                        Content="{Binding AddLanguageLabel}" />
                </StackPanel>
            </ui:CardExpander>

            <ui:Button
                Grid.Row="2"
                Margin="0,0,0,10"
                Padding="10,5"
                HorizontalAlignment="Left"
                Command="{Binding ToggleWorkCommand}"
                Content="{Binding WorkButtonContent}" /> <!-- 修改点，删除 "Label" -->

            <ui:TextBlock
                Grid.Row="3"
                Margin="0,0,0,10"
                FontSize="14"
                Text="{Binding StatusText}" />

            <ui:TextBox
                Grid.Row="4"
                Margin="0,0,0,10"
                AcceptsReturn="True"
                IsReadOnly="True"
                Text="{Binding TranslationResultText, Mode=OneWay}"
                TextWrapping="Wrap"
                VerticalScrollBarVisibility="Auto" />

            <ui:TextBlock
                Grid.Row="5"
                FontStyle="Italic"
                Foreground="Gray"
                Text="{Binding WorkHintLabel}" />
        </Grid>

        <!--  GridSplitter and Right Column for Log REMOVED  -->

    </Grid>
</Page>
```

**6. `ViewModels/IndexWindowViewModel.cs`**

*   移除 `WorkButtonContentLabel` 属性，`WorkButtonContent` 属性将直接存储本地化的动态文本。
*   添加 `RunningLogLabel` 和 `ClearLogLabel` 属性，并订阅语言变更事件。
*   将所有硬编码的状态文本和日志信息替换为 `LanguageManager.GetString()` 调用，并对包含变量的部分使用 `string.Format()`。
*   在 `LoadSettingsAndInitializeServices` 和 `ToggleWorkAsync` 中，确保 `WorkButtonContent` 属性正确地设置为 "开始工作" 或 "停止工作" 的本地化版本。

```csharp
File: ViewModels/IndexWindowViewModel.cs
```csharp
using NAudio.Wave;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using lingualink_client.Models;
using lingualink_client.Services;
using System.Diagnostics;
using System.Collections.Specialized;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;

namespace lingualink_client.ViewModels
{
    public partial class IndexWindowViewModel : ViewModelBase, IDisposable
    {
        private readonly MicrophoneManager _microphoneManager;
        private AudioService _audioService;
        private TranslationService _translationService;
        private readonly SettingsService _settingsService;
        private OscService? _oscService;
        private AppSettings _appSettings;
        
        // Target Language Properties
        public ObservableCollection<SelectableTargetLanguageViewModel> TargetLanguageItems { get; }

        private static readonly List<string> AllSupportedLanguages = new List<string> 
        { 
            "英文", "日文", "法文", "中文", "韩文", "西班牙文", "俄文", "德文", "意大利文" 
        };
        private const int MaxTargetLanguages = 5;

        // Log Properties
        public ObservableCollection<string> LogMessages { get; }
        public string FormattedLogMessages => string.Join(Environment.NewLine, LogMessages);

        private const int MaxLogEntries = 500;

        // 将属性转换为 [ObservableProperty]
        [ObservableProperty] private ObservableCollection<MMDeviceWrapper> _microphones = new ObservableCollection<MMDeviceWrapper>();

        [ObservableProperty]
        private MMDeviceWrapper? _selectedMicrophone;

        [ObservableProperty] private string _statusText; // 在构造函数中初始化
        [ObservableProperty] private string _translationResultText = string.Empty;
        [ObservableProperty] private string _workButtonContent; // 在构造函数中初始化
        [ObservableProperty] private bool _isMicrophoneComboBoxEnabled = true;

        [ObservableProperty]
        private bool _isRefreshingMicrophones = false;

        // Language-dependent labels
        // Removed WorkButtonContentLabel as it's now dynamic _workButtonContent
        public string SelectMicrophoneLabel => LanguageManager.GetString("SelectMicrophone");
        public string RefreshLabel => LanguageManager.GetString("Refresh");
        public string RefreshingMicrophonesLabel => LanguageManager.GetString("RefreshingMicrophones");
        public string TargetLanguagesLabel => LanguageManager.GetString("TargetLanguages");
        public string AddLanguageLabel => LanguageManager.GetString("AddLanguage");
        public string RemoveLabel => LanguageManager.GetString("Remove");
        public string WorkHintLabel => LanguageManager.GetString("WorkHint");
        // Added for LogPage
        public string RunningLogLabel => LanguageManager.GetString("RunningLog");
        public string ClearLogLabel => LanguageManager.GetString("ClearLog");


        public IndexWindowViewModel()
        {
            _microphoneManager = new MicrophoneManager();
            _settingsService = new SettingsService();
            
            TargetLanguageItems = new ObservableCollection<SelectableTargetLanguageViewModel>();

            LogMessages = new ObservableCollection<string>();
            LogMessages.CollectionChanged += OnLogMessagesChanged;
            
            // Set initial localized values
            _statusText = LanguageManager.GetString("StatusInitializing");
            _workButtonContent = LanguageManager.GetString("StartWork");

            AddLogMessage(LanguageManager.GetString("IndexVmCtorLogInit"));
            Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] IndexWindowViewModel Constructor: Log Initialized. Count: {LogMessages.Count}");

            LoadSettingsAndInitializeServices(); 
            SettingsChangedNotifier.SettingsChanged += OnGlobalSettingsChanged;

            _ = RefreshMicrophonesAsync();

            // Subscribe to language changes, update properties that depend on LanguageManager strings
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(SelectMicrophoneLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(RefreshLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(RefreshingMicrophonesLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(TargetLanguagesLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(AddLanguageLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(RemoveLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(WorkHintLabel));
            // Added for LogPage
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(RunningLogLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(ClearLogLabel));
            // Update dynamic button text on language change
            LanguageManager.LanguageChanged += () => WorkButtonContent = _audioService.IsWorking ? LanguageManager.GetString("StopWork") : LanguageManager.GetString("StartWork");
        }

        private void OnLogMessagesChanged(object? sender, NotifyCollectionChangedEventArgs e)
        {
            OnPropertyChanged(nameof(FormattedLogMessages));
        }
        
        private void OnGlobalSettingsChanged()
        {
            Application.Current.Dispatcher.Invoke(() =>
            {
                bool wasWorking = _audioService?.IsWorking ?? false;
                LoadSettingsAndInitializeServices(true); // This will reload _appSettings and re-init services

                // Only update status if not currently working and not already showing a specific status like "refreshing mics"
                // Checking for parts of localized strings, e.g., "OSC服务初始化失败" (StatusOscInitFailed)
                if (!wasWorking && !_audioService.IsWorking && !StatusText.Contains(LanguageManager.GetString("StatusOscInitFailed").Split(':')[0]) && !StatusText.Contains(LanguageManager.GetString("StatusRefreshingMics").Split(':')[0]))
                {
                    StatusText = LanguageManager.GetString("StatusSettingsUpdated");
                    if (!Microphones.Any() || SelectedMicrophone == null)
                    {
                        StatusText += $" {LanguageManager.GetString("StatusPleaseSelectMic")}";
                    }
                    else
                    {
                        StatusText += (_appSettings.EnableOsc && _oscService != null) ? $" {LanguageManager.GetString("StatusReadyWithOsc")}" : $" {LanguageManager.GetString("StatusReadyWithoutOsc")}";
                    }
                }
                ToggleWorkCommand.NotifyCanExecuteChanged();
                RefreshMicrophonesCommand.NotifyCanExecuteChanged();
            });
        }

        private void LoadSettingsAndInitializeServices(bool reattachAudioEvents = false)
        {
            bool wasWorking = _audioService?.IsWorking ?? false;
            int? previouslySelectedMicDeviceNumber = wasWorking ? SelectedMicrophone?.WaveInDeviceIndex : null;

            _appSettings = _settingsService.LoadSettings();

            LoadTargetLanguagesFromSettings(_appSettings);

            if (reattachAudioEvents && _audioService != null)
            {
                _audioService.AudioSegmentReady -= OnAudioSegmentReadyForTranslation;
                _audioService.StatusUpdated -= OnAudioServiceStatusUpdate;
            }
            _translationService?.Dispose();
            _audioService?.Dispose(); 
            _oscService?.Dispose(); 

            _translationService = new TranslationService(_appSettings.ServerUrl);
            _audioService = new AudioService(_appSettings);

            _audioService.AudioSegmentReady += OnAudioSegmentReadyForTranslation;
            _audioService.StatusUpdated += OnAudioServiceStatusUpdate;

            if (_appSettings.EnableOsc)
            {
                try
                {
                    _oscService = new OscService(_appSettings.OscIpAddress, _appSettings.OscPort);
                    if(!wasWorking && !StatusText.Contains(LanguageManager.GetString("StatusRefreshingMics").Split(':')[0]) && !StatusText.Contains(LanguageManager.GetString("StatusSettingsUpdated").Split(':')[0]))
                        StatusText = string.Format(LanguageManager.GetString("StatusOscEnabled"), _appSettings.OscIpAddress, _appSettings.OscPort);
                }
                catch (Exception ex)
                {
                    _oscService = null;
                    StatusText = string.Format(LanguageManager.GetString("StatusOscInitFailed"), ex.Message);
                    AddLogMessage(string.Format(LanguageManager.GetString("LogOscInitFailed"), ex.Message));
                    System.Diagnostics.Debug.WriteLine($"OSC Service Init Error: {ex.Message}");
                }
            }
            else
            {
                _oscService = null;
            }

            // Restore working state if it was working before settings change
            if (wasWorking && previouslySelectedMicDeviceNumber.HasValue && SelectedMicrophone?.WaveInDeviceIndex == previouslySelectedMicDeviceNumber)
            {
                if (_audioService.Start(previouslySelectedMicDeviceNumber.Value))
                {
                    WorkButtonContent = LanguageManager.GetString("StopWork");
                    IsMicrophoneComboBoxEnabled = false;
                }
                else 
                {
                    WorkButtonContent = LanguageManager.GetString("StartWork"); // If start failed, revert button text
                    IsMicrophoneComboBoxEnabled = true;
                }
            } else if (wasWorking) // If settings changed while working and mic changed or wasn't previously selected
            {
                 WorkButtonContent = LanguageManager.GetString("StartWork");
                 IsMicrophoneComboBoxEnabled = true;
            }

            RefreshMicrophonesCommand.NotifyCanExecuteChanged();
            ToggleWorkCommand.NotifyCanExecuteChanged();
        }

        [RelayCommand(CanExecute = nameof(CanExecuteRefreshMicrophones))]
        private async Task RefreshMicrophonesAsync()
        {
            IsRefreshingMicrophones = true;
            StatusText = LanguageManager.GetString("StatusRefreshingMics");
            IsMicrophoneComboBoxEnabled = false;

            List<MMDeviceWrapper> mics = new List<MMDeviceWrapper>();
            MMDeviceWrapper? defaultMic = null;

            try
            {
                await Task.Run(() =>
                {
                    mics = _microphoneManager.GetAvailableMicrophones(out defaultMic);
                });

                Microphones.Clear();
                foreach (var mic in mics) Microphones.Add(mic);

                if (Microphones.Any()) SelectedMicrophone = defaultMic ?? Microphones.First();
                else SelectedMicrophone = null;
            }
            catch (Exception ex)
            {
                StatusText = string.Format(LanguageManager.GetString("StatusRefreshMicsFailed"), ex.Message);
                AddLogMessage(string.Format(LanguageManager.GetString("LogRefreshMicsFailed"), ex.Message));
                System.Diagnostics.Debug.WriteLine($"RefreshMicrophones Error: {ex.ToString()}");
            }
            finally
            {
                if (SelectedMicrophone == null && !Microphones.Any()) StatusText = LanguageManager.GetString("StatusNoMicFound");
                // Only change status if it was specifically "refreshing mics" to avoid overwriting other important messages
                else if (StatusText.Contains(LanguageManager.GetString("StatusRefreshingMics").Split(':')[0])) StatusText = LanguageManager.GetString("StatusMicsRefreshed");

                IsMicrophoneComboBoxEnabled = Microphones.Any();
                IsRefreshingMicrophones = false;
                ToggleWorkCommand.NotifyCanExecuteChanged();
            }
        }

        private bool CanExecuteRefreshMicrophones() => !_audioService.IsWorking && !IsRefreshingMicrophones;

        partial void OnSelectedMicrophoneChanged(MMDeviceWrapper? oldValue, MMDeviceWrapper? newValue)
        {
             if (newValue != null)
            {
                if (newValue.WaveInDeviceIndex != -1 && newValue.WaveInDeviceIndex < WaveIn.DeviceCount)
                {
                    // Avoid overwriting status if it's already showing something more critical like OSC init failure or refreshing status
                    if (!StatusText.Contains(LanguageManager.GetString("StatusOscEnabled").Split('(')[0]) && !StatusText.Contains(LanguageManager.GetString("StatusSettingsUpdated").Split(':')[0]) && !StatusText.Contains(LanguageManager.GetString("StatusRefreshingMics").Split(':')[0]) && !_audioService.IsWorking)
                        StatusText = string.Format(LanguageManager.GetString("StatusMicSelected"), newValue.FriendlyName);
                }
                else
                {
                    int cbIndex = Microphones.IndexOf(newValue);
                    if (cbIndex >= 0 && cbIndex < WaveIn.DeviceCount) {
                        newValue.WaveInDeviceIndex = cbIndex;
                         StatusText = string.Format(LanguageManager.GetString("StatusMicSelectedFallback"), newValue.FriendlyName);
                    } else {
                        StatusText = string.Format(LanguageManager.GetString("StatusMicInvalid"), newValue.FriendlyName);
                        SelectedMicrophone = null;
                    }
                }
            } else if (!Microphones.Any()){
                 StatusText = LanguageManager.GetString("StatusNoMicFoundRefreshCheck");
            }
            ToggleWorkCommand.NotifyCanExecuteChanged();
        }

        partial void OnIsRefreshingMicrophonesChanged(bool oldValue, bool newValue)
        {
            RefreshMicrophonesCommand.NotifyCanExecuteChanged();
            ToggleWorkCommand.NotifyCanExecuteChanged();
        }

        [RelayCommand(CanExecute = nameof(CanExecuteToggleWork))]
        private async Task ToggleWorkAsync()
        {
            if (!_audioService.IsWorking)
            {
                if (SelectedMicrophone?.WaveInDeviceIndex != -1)
                {
                    bool success = false;
                    await Task.Run(() => success = _audioService.Start(SelectedMicrophone.WaveInDeviceIndex));

                    if (success)
                    {
                        WorkButtonContent = LanguageManager.GetString("StopWork");
                        IsMicrophoneComboBoxEnabled = false;
                    }
                }
                else
                {
                    MessageBox.Show(LanguageManager.GetString("MsgBoxSelectValidMicContent"), LanguageManager.GetString("MsgBoxSelectValidMicTitle"), MessageBoxButton.OK, MessageBoxImage.Error);
                }
            }
            else
            {
                await Task.Run(() => _audioService.Stop()); 
                WorkButtonContent = LanguageManager.GetString("StartWork");
                StatusText = LanguageManager.GetString("StatusStopped");
                IsMicrophoneComboBoxEnabled = true;
            }

            RefreshMicrophonesCommand.NotifyCanExecuteChanged();
            ToggleWorkCommand.NotifyCanExecuteChanged();
        }

        private bool CanExecuteToggleWork() => SelectedMicrophone != null && SelectedMicrophone.WaveInDeviceIndex != -1 && !IsRefreshingMicrophones;

        private void OnAudioServiceStatusUpdate(object? sender, string status)
        {
            Application.Current.Dispatcher.Invoke(() => {
                // AudioService's 'status' is already localized, just append it to the main status text if desired.
                // Or simply set StatusText directly to the localized status from AudioService.
                StatusText = LanguageManager.GetString("StatusListening").Split(':')[0] + ": " + status; // Example: "状态: 正在监听..."
                AddLogMessage($"AudioService Status: {status}"); // Keep raw status in detailed logs
            });
        }

        private async void OnAudioSegmentReadyForTranslation(object? sender, AudioSegmentEventArgs e)
        {
            string currentUiStatus = string.Format(LanguageManager.GetString("StatusSendingSegment"), e.TriggerReason);
            Application.Current.Dispatcher.Invoke(() => StatusText = currentUiStatus);
            AddLogMessage(string.Format(LanguageManager.GetString("LogSendingSegment"), e.TriggerReason, e.AudioData.Length, DateTime.Now));


            var waveFormat = new WaveFormat(AudioService.APP_SAMPLE_RATE, 16, AudioService.APP_CHANNELS);
            var (response, rawJsonResponse, errorMessage) = await _translationService.TranslateAudioSegmentAsync(
                e.AudioData, waveFormat, e.TriggerReason, _appSettings.TargetLanguages
            );

            string translatedTextForOsc = string.Empty;
            string logEntry;

            if (!string.IsNullOrEmpty(rawJsonResponse))
            {
                AddLogMessage(string.Format(LanguageManager.GetString("LogServerRawResponse"), e.TriggerReason, rawJsonResponse));
            }

            if (errorMessage != null)
            {
                currentUiStatus = LanguageManager.GetString("StatusTranslationFailed");
                TranslationResultText = string.Format(LanguageManager.GetString("TranslationError"), errorMessage);
                logEntry = string.Format(LanguageManager.GetString("LogTranslationError"), e.TriggerReason, errorMessage);
            }
            else if (response != null)
            {
                if (response.Status == "success" && response.Data != null && !string.IsNullOrEmpty(response.Data.Raw_Text))
                {
                    currentUiStatus = LanguageManager.GetString("StatusTranslationSuccess");
                    TranslationResultText = response.Data.Raw_Text;
                    translatedTextForOsc = response.Data.Raw_Text;
                    logEntry = string.Format(LanguageManager.GetString("LogTranslationSuccess"), e.TriggerReason, response.Data.Raw_Text, response.Duration_Seconds);
                }
                else if (response.Status == "success" && (response.Data == null || string.IsNullOrEmpty(response.Data.Raw_Text)))
                {
                    currentUiStatus = LanguageManager.GetString("StatusTranslationSuccessNoText");
                    TranslationResultText = LanguageManager.GetString("TranslationSuccessNoTextPlaceholder");
                    logEntry = string.Format(LanguageManager.GetString("LogTranslationSuccessNoText"), e.TriggerReason, response.Duration_Seconds);
                }
                else
                {
                    currentUiStatus = LanguageManager.GetString("StatusTranslationFailedServer");
                    TranslationResultText = string.Format(LanguageManager.GetString("TranslationServerError"), response.Message ?? LanguageManager.GetString("UnknownError"));
                    logEntry = string.Format(LanguageManager.GetString("LogServerError"), e.TriggerReason, response.Message ?? LanguageManager.GetString("UnknownError"));
                    if(response.Details != null) logEntry += string.Format(LanguageManager.GetString("LogServerErrorDetails"), response.Details.Content ?? "N/A");
                }
            }
            else
            {
                currentUiStatus = LanguageManager.GetString("StatusEmptyResponse");
                TranslationResultText = LanguageManager.GetString("TranslationEmptyResponseError");
                logEntry = string.Format(LanguageManager.GetString("LogEmptyResponse"), e.TriggerReason);
            }
            
            Application.Current.Dispatcher.Invoke(() => {
                StatusText = currentUiStatus;
                AddLogMessage(logEntry);
            });


            if (_appSettings.EnableOsc && _oscService != null && !string.IsNullOrEmpty(translatedTextForOsc))
            {
                Application.Current.Dispatcher.Invoke(() => StatusText = LanguageManager.GetString("StatusSendingToVRChat"));
                try
                {
                    await _oscService.SendChatboxMessageAsync(
                        translatedTextForOsc, 
                        _appSettings.OscSendImmediately, 
                        _appSettings.OscPlayNotificationSound
                    );
                    Application.Current.Dispatcher.Invoke(() => {
                        // Combine two localized strings
                        StatusText = string.Format(LanguageManager.GetString("StatusTranslationSuccess") + " " + LanguageManager.GetString("LogOscSent").Replace("[OSC] ", ""), translatedTextForOsc.Split('\n')[0]);
                        AddLogMessage(string.Format(LanguageManager.GetString("LogOscSent"), translatedTextForOsc.Split('\n')[0]));
                    });
                }
                catch (Exception ex)
                {
                    System.Diagnostics.Debug.WriteLine($"OSC Send Error: {ex.Message}");
                    Application.Current.Dispatcher.Invoke(() => {
                        string oscErrorMsg = string.Format(LanguageManager.GetString("StatusOscSendFailed"), ex.Message.Split('\n')[0]);
                        StatusText = oscErrorMsg;
                        AddLogMessage(string.Format(LanguageManager.GetString("LogOscSendFailed"), ex.Message));
                    });
                }
            }

            Application.Current.Dispatcher.Invoke(() =>
            {
                // Revert to "Listening..." status only if AudioService is still active and no other critical message is displayed
                if (_audioService.IsWorking && !StatusText.Contains(LanguageManager.GetString("AudioStatusSpeechDetected").Split('.')[0]) && !StatusText.Contains(LanguageManager.GetString("StatusTranslationFailed").Split(':')[0]) && !StatusText.Contains(LanguageManager.GetString("StatusOscSendFailed").Split(':')[0]))
                {
                    StatusText = LanguageManager.GetString("StatusListening");
                }
            });
        }

        // --- Target Language Management ---
        private void LoadTargetLanguagesFromSettings(AppSettings settings)
        {
            TargetLanguageItems.Clear();
            var languagesFromSettings = string.IsNullOrWhiteSpace(settings.TargetLanguages)
                ? new List<string>()
                : settings.TargetLanguages.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries)
                                         .Select(s => s.Trim())
                                         .Where(s => AllSupportedLanguages.Contains(s)) 
                                         .Distinct() 
                                         .ToList();

            if (!languagesFromSettings.Any())
            {
                languagesFromSettings.Add(AllSupportedLanguages.FirstOrDefault() ?? LanguageManager.GetString("DefaultEnglishLanguageName"));
            }

            foreach (var lang in languagesFromSettings.Take(MaxTargetLanguages)) 
            {
                var newItem = new SelectableTargetLanguageViewModel(this, lang, new List<string>(AllSupportedLanguages));
                TargetLanguageItems.Add(newItem);
            }
            UpdateItemPropertiesAndAvailableLanguages();
            AddLanguageCommand.NotifyCanExecuteChanged();
        }
        
        [RelayCommand(CanExecute = nameof(CanExecuteAddLanguage))]
        private void AddLanguage()
        {
            if (!CanExecuteAddLanguage()) return;
            string defaultNewLang = AllSupportedLanguages.FirstOrDefault(l => !TargetLanguageItems.Any(item => item.SelectedLanguage == l))
                                    ?? AllSupportedLanguages.First(); 
            var newItem = new SelectableTargetLanguageViewModel(this, defaultNewLang, new List<string>(AllSupportedLanguages));
            TargetLanguageItems.Add(newItem);
            UpdateItemPropertiesAndAvailableLanguages();
            AddLanguageCommand.NotifyCanExecuteChanged();
            SaveCurrentSettings();
        }

        private bool CanExecuteAddLanguage()
        {
            return TargetLanguageItems.Count < MaxTargetLanguages;
        }

        public void RemoveLanguageItem(SelectableTargetLanguageViewModel itemToRemove)
        {
            if (TargetLanguageItems.Contains(itemToRemove))
            {
                TargetLanguageItems.Remove(itemToRemove);
                UpdateItemPropertiesAndAvailableLanguages();
                AddLanguageCommand.NotifyCanExecuteChanged();
                SaveCurrentSettings();
            }
        }

        public void OnLanguageSelectionChanged(SelectableTargetLanguageViewModel changedItem)
        {
            UpdateItemPropertiesAndAvailableLanguages();
            SaveCurrentSettings();
        }

        private void UpdateItemPropertiesAndAvailableLanguages()
        {
            for (int i = 0; i < TargetLanguageItems.Count; i++)
            {
                var itemVm = TargetLanguageItems[i];
                itemVm.Label = $"目标 {i + 1}:"; // This string could also be localized if "目标" is dynamic, but for now it's fine.
                itemVm.CanRemove = TargetLanguageItems.Count > 1; 
                var availableForThisDropdown = new ObservableCollection<string>();
                foreach (var langOption in AllSupportedLanguages)
                {
                    if (langOption == itemVm.SelectedLanguage || 
                        !TargetLanguageItems.Where(it => it != itemVm).Any(it => it.SelectedLanguage == langOption))
                    {
                        availableForThisDropdown.Add(langOption);
                    }
                }
                if (!string.IsNullOrEmpty(itemVm.SelectedLanguage) && !availableForThisDropdown.Contains(itemVm.SelectedLanguage))
                {
                    availableForThisDropdown.Add(itemVm.SelectedLanguage); 
                }
                itemVm.AvailableLanguages = availableForThisDropdown;
            }
        }

        private void SaveCurrentSettings()
        {
            var selectedLangsList = TargetLanguageItems
                .Select(item => item.SelectedLanguage)
                .Where(lang => !string.IsNullOrWhiteSpace(lang) && AllSupportedLanguages.Contains(lang))
                .Distinct()
                .ToList();
            _appSettings.TargetLanguages = string.Join(",", selectedLangsList);

            _settingsService.SaveSettings(_appSettings);
            SettingsChangedNotifier.RaiseSettingsChanged();
            AddLogMessage(LanguageManager.GetString("LogTargetLangsSaved"));
        }

        // --- Log Management ---
        private void AddLogMessage(string message)
        {
            Debug.WriteLine($"AddLogMessage INVOKED with: \"{message}\". Current LogMessages count before add: {LogMessages.Count}");
            Application.Current.Dispatcher.Invoke(() =>
            {
                string timestampedMessage = $"{DateTime.Now:HH:mm:ss.fff} - {message}";
                LogMessages.Add(timestampedMessage);
                Debug.WriteLine($"LogMessages UPDATED. New count: {LogMessages.Count}. Last message: \"{LogMessages.LastOrDefault()}\"");
                while (LogMessages.Count > MaxLogEntries)
                {
                    LogMessages.RemoveAt(0);
                }
            });
        }

        [RelayCommand]
        private void ClearLog()
        {
            Debug.WriteLine($"ExecuteClearLog INVOKED. LogMessages count BEFORE clear: {LogMessages.Count}");
            LogMessages.Clear();
            Debug.WriteLine($"ExecuteClearLog: LogMessages.Clear() called. LogMessages count AFTER clear: {LogMessages.Count}");
            AddLogMessage(LanguageManager.GetString("LogCleared"));
        }

        public void Dispose()
        {
            SettingsChangedNotifier.SettingsChanged -= OnGlobalSettingsChanged;
            if (LogMessages != null)
            {
                LogMessages.CollectionChanged -= OnLogMessagesChanged;
            }
            if (_audioService != null)
            {
                _audioService.AudioSegmentReady -= OnAudioSegmentReadyForTranslation;
                _audioService.StatusUpdated -= OnAudioServiceStatusUpdate;
                _audioService.Dispose();
            }
            _translationService?.Dispose();
            _oscService?.Dispose(); 
            GC.SuppressFinalize(this);
        }
    }
}
```

**7. `Services/AudioService.cs`**

*   将所有状态更新消息替换为 `LanguageManager.GetString()` 调用。

```csharp
File: Services/AudioService.cs
```csharp
using NAudio.Wave;
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading.Tasks;
using lingualink_client.Models; 
using WebRtcVadSharp; 

namespace lingualink_client.Services
{
    public class AudioService : IDisposable
    {
        // --- VAD 和音频处理相关常量 ---
        private const FrameLength VAD_FRAME_LENGTH = FrameLength.Is30ms;
        private const SampleRate VAD_SAMPLE_RATE_ENUM = SampleRate.Is16kHz;
        public const int APP_SAMPLE_RATE = 16000; 
        public const int APP_CHANNELS = 1;
        private const int APP_BITS_PER_SAMPLE = 16;
        private readonly int _vadFrameSizeInBytes;

        // --- VAD 参数 ---
        private readonly double _silenceThresholdSeconds;
        private readonly double _minVoiceDurationSeconds;
        private readonly double _maxVoiceDurationSeconds;
        private readonly double _minRecordingVolumeThreshold;

        // --- VAD 状态变量 ---
        private bool _isSpeaking = false;
        private DateTime _lastVoiceActivityTime;
        private List<byte> _currentAudioSegment = new List<byte>();
        private WebRtcVad? _vadInstance;

        private WaveInEvent? _waveSource;
        private readonly object _vadLock = new object();
        private bool _isCurrentlyWorking = false; 

        public event EventHandler<AudioSegmentEventArgs>? AudioSegmentReady;
        public event EventHandler<string>? StatusUpdated; 

        public AudioService(AppSettings settings)
        {
            _vadFrameSizeInBytes = (APP_SAMPLE_RATE / 1000) * (APP_BITS_PER_SAMPLE / 8) * (int)VAD_FRAME_LENGTH * APP_CHANNELS;
            _silenceThresholdSeconds = settings.SilenceThresholdSeconds;
            _minVoiceDurationSeconds = settings.MinVoiceDurationSeconds;
            _maxVoiceDurationSeconds = settings.MaxVoiceDurationSeconds;
            _minRecordingVolumeThreshold = settings.MinRecordingVolumeThreshold;
        }

        public bool IsWorking => _isCurrentlyWorking;

        public bool Start(int microphoneDeviceNumber)
        {
            if (_isCurrentlyWorking) return true; 

            _isSpeaking = false;
            _currentAudioSegment.Clear();

            try
            {
                _vadInstance = new WebRtcVad
                {
                    OperatingMode = OperatingMode.Aggressive,
                    FrameLength = VAD_FRAME_LENGTH,
                    SampleRate = VAD_SAMPLE_RATE_ENUM
                };

                _waveSource = new WaveInEvent
                {
                    DeviceNumber = microphoneDeviceNumber,
                    BufferMilliseconds = (int)VAD_FRAME_LENGTH * 2, 
                    WaveFormat = new WaveFormat(APP_SAMPLE_RATE, APP_BITS_PER_SAMPLE, APP_CHANNELS)
                };
                _waveSource.DataAvailable += OnVadDataAvailable;
                _waveSource.RecordingStopped += OnRecordingStoppedHandler;
                _waveSource.StartRecording();
                _isCurrentlyWorking = true;
                StatusUpdated?.Invoke(this, LanguageManager.GetString("AudioStatusListening")); // 修改点
                return true;
            }
            catch (Exception ex)
            {
                StatusUpdated?.Invoke(this, string.Format(LanguageManager.GetString("AudioStatusStartFailed"), ex.Message)); // 修改点
                System.Diagnostics.Debug.WriteLine($"AudioService Start Error: {ex.Message}");
                Stop(true); 
                return false;
            }
        }

        public void Stop(bool processFinalSegment = true)
        {
            if (!_isCurrentlyWorking && _waveSource == null && _vadInstance == null) return; 

            _isCurrentlyWorking = false; 

            if (_waveSource != null)
            {
                try { _waveSource.StopRecording(); } 
                catch (Exception ex) {
                    System.Diagnostics.Debug.WriteLine($"Error stopping waveSource: {ex.Message}");
                    CleanupWaveSourceResources(); 
                }
            } else {
                CleanupWaveSourceResources(); 
            }

            if (processFinalSegment && _currentAudioSegment.Count > 0 && GetSegmentDurationSeconds(_currentAudioSegment.Count) >= _minVoiceDurationSeconds)
            {
                AudioSegmentReady?.Invoke(this, new AudioSegmentEventArgs(_currentAudioSegment.ToArray(), "final_on_stop"));
            }
            _currentAudioSegment.Clear();
            _isSpeaking = false;
        }

        private double CalculatePeakVolume(byte[] pcm16BitAudioFrame, int bytesToProcess)
        {
            if (pcm16BitAudioFrame == null || bytesToProcess == 0)
                return 0.0;

            short maxSampleMagnitude = 0;

            for (int i = 0; i < bytesToProcess; i += 2)
            {
                if (i + 1 < bytesToProcess)
                {
                    short sample = BitConverter.ToInt16(pcm16BitAudioFrame, i);
                    short currentMagnitude;

                    if (sample == short.MinValue)
                    {
                        currentMagnitude = short.MaxValue;
                    }
                    else
                    {
                        currentMagnitude = Math.Abs(sample);
                    }

                    if (currentMagnitude > maxSampleMagnitude)
                    {
                        maxSampleMagnitude = currentMagnitude;
                    }
                }
            }
            return (double)maxSampleMagnitude / short.MaxValue;
        }


        private void OnVadDataAvailable(object? sender, WaveInEventArgs e)
        {
            if (!_isCurrentlyWorking || _vadInstance == null) return;

            for (int offset = 0; offset < e.BytesRecorded; offset += _vadFrameSizeInBytes)
            {
                int bytesInCurrentVadFrame = Math.Min(_vadFrameSizeInBytes, e.BytesRecorded - offset);
                if (bytesInCurrentVadFrame < _vadFrameSizeInBytes && bytesInCurrentVadFrame > 0)
                {
                    break; 
                }
                if (bytesInCurrentVadFrame == 0) break;


                byte[] frameForVad = new byte[_vadFrameSizeInBytes];
                Buffer.BlockCopy(e.Buffer, offset, frameForVad, 0, _vadFrameSizeInBytes);

                bool voiceDetectedThisFrame;

                double peakVolume = CalculatePeakVolume(frameForVad, _vadFrameSizeInBytes);

                if (peakVolume < _minRecordingVolumeThreshold && _minRecordingVolumeThreshold > 0)
                {
                    voiceDetectedThisFrame = false;
                }
                else
                {
                    try
                    {
                        voiceDetectedThisFrame = _vadInstance.HasSpeech(frameForVad);
                    }
                    catch (Exception ex)
                    {
                        System.Diagnostics.Debug.WriteLine($"WebRtcVad.HasSpeech error: {ex.Message}");
                        voiceDetectedThisFrame = false;
                    }
                }

                lock (_vadLock)
                {
                    if (voiceDetectedThisFrame)
                    {
                        if (!_isSpeaking)
                        {
                            _isSpeaking = true;
                            StatusUpdated?.Invoke(this, LanguageManager.GetString("AudioStatusSpeechDetected")); // 修改点
                        }
                        _currentAudioSegment.AddRange(frameForVad);
                        _lastVoiceActivityTime = DateTime.UtcNow;

                        if (GetSegmentDurationSeconds(_currentAudioSegment.Count) >= _maxVoiceDurationSeconds)
                        {
                            var segmentData = _currentAudioSegment.ToArray();
                            _currentAudioSegment.Clear();
                            _lastVoiceActivityTime = DateTime.UtcNow; 
                            AudioSegmentReady?.Invoke(this, new AudioSegmentEventArgs(segmentData, "max_duration_split"));
                            if (_isCurrentlyWorking && _isSpeaking) StatusUpdated?.Invoke(this, LanguageManager.GetString("AudioStatusSpeechDetectedSplit")); // 修改点
                        }
                    }
                    else
                    {
                    }
                }
            }
            CheckSilenceTimeout();
        }


        private void CheckSilenceTimeout()
        {
            if (!_isCurrentlyWorking) return;
            lock (_vadLock)
            {
                if (_isSpeaking && (DateTime.UtcNow - _lastVoiceActivityTime).TotalSeconds >= _silenceThresholdSeconds)
                {
                    _isSpeaking = false;
                    var segmentData = _currentAudioSegment.ToArray();
                    _currentAudioSegment.Clear();

                    StatusUpdated?.Invoke(this, LanguageManager.GetString("AudioStatusSilenceDetectedProcess")); // 修改点

                    if (segmentData.Length > 0 && GetSegmentDurationSeconds(segmentData.Length) >= _minVoiceDurationSeconds)
                    {
                        AudioSegmentReady?.Invoke(this, new AudioSegmentEventArgs(segmentData, "silence_timeout"));
                        if (_isCurrentlyWorking && !_isSpeaking) StatusUpdated?.Invoke(this, LanguageManager.GetString("AudioStatusListening")); // 修改点
                    }
                    else if (segmentData.Length > 0)
                    {
                        StatusUpdated?.Invoke(this, LanguageManager.GetString("AudioStatusSegmentTooShort")); // 修改点
                    }
                }
            }
        }

        private void OnRecordingStoppedHandler(object? sender, StoppedEventArgs e)
        {
            CleanupWaveSourceResources(); 
            if (e.Exception != null)
            {
                StatusUpdated?.Invoke(this, string.Format(LanguageManager.GetString("AudioStatusFatalError"), e.Exception.Message)); // 修改点
                _isCurrentlyWorking = false; 
            }
        }
        
        private void CleanupWaveSourceResources()
        {
            if (_waveSource != null)
            {
                _waveSource.DataAvailable -= OnVadDataAvailable;
                _waveSource.RecordingStopped -= OnRecordingStoppedHandler;
                try { _waveSource.Dispose(); } catch (Exception ex) { System.Diagnostics.Debug.WriteLine($"Error disposing waveSource: {ex.Message}"); }
                _waveSource = null;
            }
        }

        private double GetSegmentDurationSeconds(int byteCount)
        {
            if (APP_SAMPLE_RATE == 0 || APP_CHANNELS == 0 || APP_BITS_PER_SAMPLE == 0) return 0;
            return (double)byteCount / (APP_SAMPLE_RATE * (APP_BITS_PER_SAMPLE / 8) * APP_CHANNELS);
        }

        public void Dispose()
        {
            Stop(false); 
            _vadInstance?.Dispose();
            _vadInstance = null;
            GC.SuppressFinalize(this);
        }
    }
}
```

**8. `Views/Pages/LogPage.xaml`**

*   确保 `RunningLogLabel` 和 `ClearLogLabel` 正确绑定。

```xml
File: Views/Pages/LogPage.xaml
```xml
<Page
    x:Class="lingualink_client.Views.LogPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:lingualink_client.ViewModels"
    Title="LogPage"
    d:DataContext="{d:DesignInstance Type=vm:IndexWindowViewModel}"
    mc:Ignorable="d">

    <Grid Margin="15">
        <!--  Increased margin for a page view  -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!--  Log Label & Clear Button  -->
            <RowDefinition Height="*" />
            <!--  Log TextBox  -->
        </Grid.RowDefinitions>

        <StackPanel
            Grid.Row="0"
            Margin="0,0,0,10"
            Orientation="Horizontal">
            <Label
                VerticalAlignment="Center"
                Content="{Binding RunningLogLabel}" <!-- 修改点 -->
                FontSize="16"
                FontWeight="SemiBold" />
            <ui:Button
                Margin="15,0,0,0"
                Padding="8,4"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"
                Command="{Binding ClearLogCommand}"
                Content="{Binding ClearLogLabel}" /> <!-- 修改点 -->
        </StackPanel>

        <ui:TextBox
            Grid.Row="1"
            AcceptsReturn="True"
            FontFamily="Consolas"
            FontSize="12"
            IsReadOnly="True"
            Text="{Binding FormattedLogMessages, Mode=OneWay}"
            TextWrapping="Wrap"
            VerticalScrollBarVisibility="Auto" />
    </Grid>
</Page>
```

**9. `Views/Pages/ServicePage.xaml`**

*   更新音量阈值提示文本的绑定。

```xml
File: Views/Pages/ServicePage.xaml
```xml
﻿<Page
    x:Class="lingualink_client.Views.ServicePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:lingualink_client.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:lingualink_client.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:lingualink_client.ViewModels"
    Title="ServicePage"
    d:DataContext="{d:DesignInstance Type=vm:ServicePageViewModel}"
    d:DesignHeight="600"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <ui:PassiveScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="15">
            <Grid.RowDefinitions>
                <!--  Row 0-3 were for Target Languages, now removed  -->
                <RowDefinition Height="Auto" />
                <!--  Server URL Label  -->
                <RowDefinition Height="Auto" />
                <!--  Server URL TextBox  -->
                <RowDefinition Height="Auto" />
                <!--  VAD Expander  -->
                <RowDefinition Height="Auto" />
                <!--  OSC Expander  -->
                <RowDefinition Height="*" />
                <!--  Spacer  -->
                <RowDefinition Height="Auto" />
                <!--  Save/Cancel Buttons  -->
            </Grid.RowDefinitions>

            <!--  Target Language UI Removed  -->

            <Label Grid.Row="0" Content="{Binding ServerUrlLabel}" />
            <ui:TextBox
                x:Name="ServerUrlTextBox"
                Grid.Row="1"
                Height="52"
                Margin="0,0,0,10"
                VerticalContentAlignment="Center"
                Text="{Binding ServerUrl, UpdateSourceTrigger=PropertyChanged}" />

            <ui:CardExpander
                Grid.Row="2"
                Margin="0,0,0,10"
                Header="{Binding SilenceThresholdLabel}"
                IsExpanded="False">
                <StackPanel Margin="10,5,0,0">
                    <Label Content="{Binding SilenceThresholdLabel}" />
                    <ui:TextBox Margin="0,0,0,5" Text="{Binding SilenceThresholdSeconds, UpdateSourceTrigger=PropertyChanged, StringFormat='N2'}" />
                    <Label Content="{Binding MinVoiceDurationLabel}" />
                    <ui:TextBox Margin="0,0,0,5" Text="{Binding MinVoiceDurationSeconds, UpdateSourceTrigger=PropertyChanged, StringFormat='N2'}" />
                    <Label Content="{Binding MaxVoiceDurationLabel}" />
                    <ui:TextBox Margin="0,0,0,5" Text="{Binding MaxVoiceDurationSeconds, UpdateSourceTrigger=PropertyChanged, StringFormat='N2'}" />
                    <Label Margin="0,5,0,0" Content="{Binding MinVolumeThresholdLabel}" />
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Slider
                            Grid.Column="0"
                            Margin="0,0,5,5"
                            VerticalAlignment="Center"
                            LargeChange="0.1"
                            Maximum="1.0"
                            Minimum="0"
                            SmallChange="0.01"
                            TickFrequency="0.05"
                            Value="{Binding MinRecordingVolumeThreshold, UpdateSourceTrigger=PropertyChanged}" />
                        <ui:TextBox
                            Grid.Column="1"
                            Width="50"
                            Margin="0,0,0,5"
                            VerticalAlignment="Center"
                            Text="{Binding MinRecordingVolumeThreshold, StringFormat='P0', UpdateSourceTrigger=PropertyChanged}"
                            TextAlignment="Right" />
                    </Grid>
                    <ui:TextBlock
                        FontSize="10"
                        FontStyle="Italic"
                        Foreground="Gray"
                        Text="{Binding VolumeThresholdHint}" <!-- 修改点 -->
                        TextWrapping="Wrap" />
                </StackPanel>
            </ui:CardExpander>

            <ui:CardExpander
                Grid.Row="3"
                Margin="0,0,0,10"
                Header="{Binding EnableOscLabel}"
                IsExpanded="False">
                <StackPanel Margin="10,5,0,0">
                    <CheckBox
                        Margin="0,0,0,5"
                        Content="{Binding EnableOscLabel}"
                        IsChecked="{Binding EnableOsc}" />
                    <Grid IsEnabled="{Binding EnableOsc}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label
                            Grid.Row="0"
                            Grid.Column="0"
                            VerticalAlignment="Center"
                            Content="{Binding OscIpAddressLabel}" />
                        <ui:TextBox
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="0,0,0,5"
                            VerticalAlignment="Center"
                            Text="{Binding OscIpAddress, UpdateSourceTrigger=PropertyChanged}" />
                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            VerticalAlignment="Center"
                            Content="{Binding OscPortLabel}" />
                        <ui:TextBox
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="0,0,0,5"
                            VerticalAlignment="Center"
                            Text="{Binding OscPort, UpdateSourceTrigger=PropertyChanged}" />
                        <CheckBox
                            Grid.Row="2"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="0,5,0,5"
                            Content="{Binding SendImmediatelyLabel}"
                            IsChecked="{Binding OscSendImmediately}" />
                        <CheckBox
                            Grid.Row="3"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="0,0,0,5"
                            Content="{Binding PlayNotificationSoundLabel}"
                            IsChecked="{Binding OscPlayNotificationSound}" />
                    </Grid>
                </StackPanel>
            </ui:CardExpander>

            <StackPanel
                Grid.Row="5"
                Margin="0,10,0,0"
                HorizontalAlignment="Right"
                Orientation="Horizontal">
                <ui:Button
                    Width="80"
                    Margin="0,0,10,0"
                    Command="{Binding SaveCommand}"
                    Content="{Binding SaveLabel}"
                    IsDefault="True" />
                <ui:Button
                    Width="80"
                    Command="{Binding RevertCommand}"
                    Content="{Binding RevertLabel}"
                    IsCancel="False" />
            </StackPanel>
        </Grid>
    </ui:PassiveScrollViewer>
</Page>
```

**10. `ViewModels/ServicePageViewModel.cs`**

*   添加 `VolumeThresholdHint` 属性并订阅语言变更事件。
*   将 `MessageBox.Show` 中的所有硬编码文本替换为 `LanguageManager.GetString()` 调用。

```csharp
File: ViewModels/ServicePageViewModel.cs
```csharp
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using lingualink_client.Models;
using lingualink_client.Services;
using System; 
using System.Net;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;

namespace lingualink_client.ViewModels
{
    public partial class ServicePageViewModel : ViewModelBase
    {
        private readonly SettingsService _settingsService;
        private AppSettings _currentSettings; 

        // Language-dependent labels
        public string ServerUrlLabel => LanguageManager.GetString("ServerUrl");
        public string SilenceThresholdLabel => LanguageManager.GetString("SilenceThreshold");
        public string MinVoiceDurationLabel => LanguageManager.GetString("MinVoiceDuration");
        public string MaxVoiceDurationLabel => LanguageManager.GetString("MaxVoiceDuration");
        public string MinVolumeThresholdLabel => LanguageManager.GetString("MinVolumeThreshold");
        public string EnableOscLabel => LanguageManager.GetString("EnableOsc");
        public string OscIpAddressLabel => LanguageManager.GetString("OscIpAddress");
        public string OscPortLabel => LanguageManager.GetString("OscPort");
        public string SendImmediatelyLabel => LanguageManager.GetString("SendImmediately");
        public string PlayNotificationSoundLabel => LanguageManager.GetString("PlayNotificationSound");
        public string SaveLabel => LanguageManager.GetString("Save");
        public string RevertLabel => LanguageManager.GetString("Revert");
        public string VolumeThresholdHint => LanguageManager.GetString("VolumeThresholdHint"); // 新增

        // [ObservableProperty] properties
        [ObservableProperty] private string _serverUrl;
        [ObservableProperty] private double _silenceThresholdSeconds;
        [ObservableProperty] private double _minVoiceDurationSeconds;
        [ObservableProperty] private double _maxVoiceDurationSeconds;
        [ObservableProperty]
        private double _minRecordingVolumeThreshold;
        [ObservableProperty] private bool _enableOsc;
        [ObservableProperty] private string _oscIpAddress;
        [ObservableProperty] private int _oscPort;
        [ObservableProperty] private bool _oscSendImmediately;
        [ObservableProperty] private bool _oscPlayNotificationSound;
        
        public ServicePageViewModel(SettingsService settingsService)
        {
            _settingsService = settingsService;
            _currentSettings = _settingsService.LoadSettings();
            
            LoadSettingsFromModel(_currentSettings);

            // Subscribe to language changes, update properties that depend on LanguageManager strings
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(ServerUrlLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(SilenceThresholdLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(MinVoiceDurationLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(MaxVoiceDurationLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(MinVolumeThresholdLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(EnableOscLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(OscIpAddressLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(OscPortLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(SendImmediatelyLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(PlayNotificationSoundLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(SaveLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(RevertLabel));
            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(VolumeThresholdHint)); // 订阅语言变更
        }

        // MinRecordingVolumeThreshold 属性的 OnChanged 回调
        partial void OnMinRecordingVolumeThresholdChanged(double oldValue, double newValue)
        {
            if (newValue < 0.0 || newValue > 1.0)
            {
                _minRecordingVolumeThreshold = Math.Clamp(newValue, 0.0, 1.0);
                OnPropertyChanged(nameof(MinRecordingVolumeThreshold));
            }
        }

        private void LoadSettingsFromModel(AppSettings settings)
        {
            ServerUrl = settings.ServerUrl;
            SilenceThresholdSeconds = settings.SilenceThresholdSeconds;
            MinVoiceDurationSeconds = settings.MinVoiceDurationSeconds;
            MaxVoiceDurationSeconds = settings.MaxVoiceDurationSeconds;
            MinRecordingVolumeThreshold = settings.MinRecordingVolumeThreshold;

            EnableOsc = settings.EnableOsc;
            OscIpAddress = settings.OscIpAddress;
            OscPort = settings.OscPort;
            OscSendImmediately = settings.OscSendImmediately;
            OscPlayNotificationSound = settings.OscPlayNotificationSound;
        }

        private bool ValidateAndBuildSettings(out AppSettings? updatedSettings)
        {
            updatedSettings = _settingsService.LoadSettings();

            if (string.IsNullOrWhiteSpace(ServerUrl) || !Uri.TryCreate(ServerUrl, UriKind.Absolute, out _))
            {
                MessageBox.Show(LanguageManager.GetString("ValidationServerUrlInvalid"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); // 修改点
                return false;
            }
            if (SilenceThresholdSeconds <= 0) { MessageBox.Show(LanguageManager.GetString("ValidationSilenceThresholdInvalid"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); return false; } // 修改点
            if (MinVoiceDurationSeconds <= 0) { MessageBox.Show(LanguageManager.GetString("ValidationMinVoiceDurationInvalid"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); return false; } // 修改点
            if (MaxVoiceDurationSeconds <= 0) { MessageBox.Show(LanguageManager.GetString("ValidationMaxVoiceDurationInvalid"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); return false; } // 修改点
            if (MinVoiceDurationSeconds >= MaxVoiceDurationSeconds) { MessageBox.Show(LanguageManager.GetString("ValidationMinMaxVoiceDuration"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); return false; } // 修改点

            if (EnableOsc)
            {
                if (string.IsNullOrWhiteSpace(OscIpAddress) || Uri.CheckHostName(OscIpAddress) == UriHostNameType.Unknown)
                {
                     if (!IPAddress.TryParse(OscIpAddress, out _)) 
                     {
                        MessageBox.Show(LanguageManager.GetString("ValidationOscIpInvalid"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); // 修改点
                        return false;
                     }
                }
                if (OscPort <= 0 || OscPort > 65535)
                {
                    MessageBox.Show(LanguageManager.GetString("ValidationOscPortInvalid"), LanguageManager.GetString("ValidationErrorTitle"), MessageBoxButton.OK, MessageBoxImage.Error); // 修改点
                    return false;
                }
            }
            
            if (updatedSettings == null) updatedSettings = new AppSettings();

            updatedSettings.ServerUrl = this.ServerUrl;
            updatedSettings.SilenceThresholdSeconds = this.SilenceThresholdSeconds;
            updatedSettings.MinVoiceDurationSeconds = this.MinVoiceDurationSeconds;
            updatedSettings.MaxVoiceDurationSeconds = this.MaxVoiceDurationSeconds;
            updatedSettings.MinRecordingVolumeThreshold = this.MinRecordingVolumeThreshold;
            updatedSettings.EnableOsc = this.EnableOsc;
            updatedSettings.OscIpAddress = this.OscIpAddress;
            updatedSettings.OscPort = this.OscPort;
            updatedSettings.OscSendImmediately = this.OscSendImmediately;
            updatedSettings.OscPlayNotificationSound = this.OscPlayNotificationSound;
            
            return true;
        }

        [RelayCommand]
        private void ExecuteSaveSettings()
        {
            if (ValidateAndBuildSettings(out AppSettings? updatedSettingsFromThisPage))
            {
                if (updatedSettingsFromThisPage != null)
                {
                    _settingsService.SaveSettings(updatedSettingsFromThisPage);
                    _currentSettings = updatedSettingsFromThisPage;
                    SettingsChangedNotifier.RaiseSettingsChanged();
                    MessageBox.Show(LanguageManager.GetString("SettingsSavedSuccess"), LanguageManager.GetString("SuccessTitle"), MessageBoxButton.OK, MessageBoxImage.Information); // 修改点
                }
            }
        }

        [RelayCommand]
        private void ExecuteRevertSettings()
        {
            _currentSettings = _settingsService.LoadSettings();
            LoadSettingsFromModel(_currentSettings);
            MessageBox.Show(LanguageManager.GetString("SettingsReverted"), LanguageManager.GetString("InfoTitle"), MessageBoxButton.OK, MessageBoxImage.Information); // 修改点
        }
    }
}
```

**11. `Services/TranslationService.cs`**

*   将所有错误信息替换为 `LanguageManager.GetString()` 调用。

```csharp
File: Services/TranslationService.cs
```csharp
using System;
using System.IO;
using System.Net.Http;
using System.Threading.Tasks;
using NAudio.Wave;
using System.Text.Json;
using lingualink_client.Models;
using System.Diagnostics;
using System.Collections.Generic;
using System.Linq;

namespace lingualink_client.Services
{
    public class TranslationService : IDisposable
    {
        private readonly string _serverUrl;
        private readonly HttpClient _httpClient;
        private bool _disposed = false;

        public TranslationService(string serverUrl)
        {
            _serverUrl = serverUrl;
            _httpClient = new HttpClient { Timeout = TimeSpan.FromSeconds(30) };
        }

        public async Task<(ServerResponse? Response, string? RawJsonResponse, string? ErrorMessage)> TranslateAudioSegmentAsync(
            byte[] audioData,
            WaveFormat waveFormat,
            string triggerReason,
            string targetLanguagesCsv)
        {
            if (audioData.Length == 0)
            {
                return (null, null, LanguageManager.GetString("ErrorAudioEmpty")); // 修改点
            }

            string tempFilePath = Path.Combine(Path.GetTempPath(), $"segment_{DateTime.Now:yyyyMMddHHmmssfff}_{triggerReason}.wav");
            string? responseContentString = null;
            try
            {
                await using (var writer = new WaveFileWriter(tempFilePath, waveFormat))
                {
                    await writer.WriteAsync(audioData, 0, audioData.Length);
                }

                using (var formData = new MultipartFormDataContent())
                {
                    var fileBytes = await File.ReadAllBytesAsync(tempFilePath);
                    var fileContent = new ByteArrayContent(fileBytes);
                    fileContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("audio/wav");
                    formData.Add(fileContent, "audio_file", Path.GetFileName(tempFilePath));

                    if (!string.IsNullOrWhiteSpace(targetLanguagesCsv))
                    {
                        var languagesList = targetLanguagesCsv.Split(',')
                                                              .Select(lang => lang.Trim())
                                                              .Where(lang => !string.IsNullOrWhiteSpace(lang));
                        foreach (var lang in languagesList)
                        {
                            Debug.WriteLine($"[DEBUG] TranslationService: 添加 'target_languages' = '{lang}'");
                            formData.Add(new StringContent(lang), "target_languages");
                        }
                    }

                    var httpResponse = await _httpClient.PostAsync(_serverUrl, formData);
                    responseContentString = await httpResponse.Content.ReadAsStringAsync();

                    if (httpResponse.IsSuccessStatusCode)
                    {
                        try
                        {
                            var serverResponse = JsonSerializer.Deserialize<ServerResponse>(responseContentString, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });
                            return (serverResponse, responseContentString, null);
                        }
                        catch (JsonException ex)
                        {
                            return (null, responseContentString, string.Format(LanguageManager.GetString("ErrorDeserializingSuccessResponse"), ex.Message, responseContentString)); // 修改点
                        }
                    }
                    else
                    {
                        try
                        {
                            var errorResponse = JsonSerializer.Deserialize<ServerResponse>(responseContentString, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });
                            if (errorResponse != null && !string.IsNullOrEmpty(errorResponse.Message))
                            {
                                return (errorResponse, responseContentString, string.Format(LanguageManager.GetString("ErrorServer"), (int)httpResponse.StatusCode, errorResponse.Message)); // 修改点
                            }
                        }
                        catch { }
                        return (null, responseContentString, string.Format(LanguageManager.GetString("ErrorServer"), (int)httpResponse.StatusCode, responseContentString)); // 修改点
                    }
                }
            }
            catch (TaskCanceledException ex)
            {
                return (null, responseContentString, string.Format(LanguageManager.GetString("ErrorNetworkTimeout"), ex.Message)); // 修改点
            }
            catch (HttpRequestException ex)
            {
                return (null, responseContentString, string.Format(LanguageManager.GetString("ErrorNetworkRequest"), ex.Message)); // 修改点
            }
            catch (Exception ex)
            {
                return (null, responseContentString, string.Format(LanguageManager.GetString("ErrorProcessingSendingSegment"), ex.Message)); // 修改点
            }
            finally
            {
                if (File.Exists(tempFilePath))
                {
                    try { File.Delete(tempFilePath); } catch { }
                }
            }
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!_disposed)
            {
                if (disposing)
                {
                    _httpClient?.Dispose();
                }
                _disposed = true;
            }
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
    }
}
```

**12. `ViewModels/SelectableTargetLanguageViewModel.cs`**

*   确认 `RemoveItemCommand` 对应 `[RelayCommand] private void RemoveItem()`。代码已正确。

```csharp
File: ViewModels/SelectableTargetLanguageViewModel.cs
```csharp
using System.Collections.ObjectModel;
using System.Collections.Generic; // For List<string>
using lingualink_client.Services;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;

namespace lingualink_client.ViewModels
{
    public partial class SelectableTargetLanguageViewModel : ViewModelBase
    {
        public IndexWindowViewModel ParentViewModel { get; }

        [ObservableProperty]
        private string _selectedLanguage;

        [ObservableProperty]
        private ObservableCollection<string> _availableLanguages;

        [ObservableProperty] private string _label;

        public string LabelText => LanguageManager.GetString("TargetLanguageLabel");

        [ObservableProperty]
        private bool _canRemove;

        public SelectableTargetLanguageViewModel(IndexWindowViewModel parent, string initialSelection, List<string> allLangsSeed)
        {
            ParentViewModel = parent;
            _availableLanguages = new ObservableCollection<string>(allLangsSeed);
            _selectedLanguage = initialSelection;

            LanguageManager.LanguageChanged += () => OnPropertyChanged(nameof(LabelText));
        }

        partial void OnSelectedLanguageChanged(string oldValue, string newValue)
        {
            ParentViewModel?.OnLanguageSelectionChanged(this);
        }

        partial void OnCanRemoveChanged(bool oldValue, bool newValue)
        {
            RemoveItemCommand.NotifyCanExecuteChanged();
        }

        [RelayCommand(CanExecute = nameof(CanRemove))]
        private void RemoveItem()
        {
            ParentViewModel.RemoveLanguageItem(this);
        }
    }
}
```

---

**部署与测试：**

1.  保存所有修改后的文件。
2.  确保 `Properties/Lang.Designer.cs` 和 `Properties/Lang.zh-CN.Designer.cs` 文件已自动生成或手动更新（通常在保存 `.resx` 文件时 Visual Studio 会自动完成）。如果未自动生成，可以在解决方案资源管理器中右键点击 `.resx` 文件，选择“运行自定义工具”。
3.  编译并运行项目。
4.  检查 `MainWindow` 标题、`IndexPage` 的工作按钮文本、状态栏、麦克风选择、日志页面、`ServicePage` 的提示文本以及各种消息框是否都已正确本地化。尝试切换语言以验证国际化功能。

通过这些修改，应用程序的本地化程度将大大提高，用户体验也会更加完善。